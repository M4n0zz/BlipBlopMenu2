import sys

if len(sys.argv) != 2:
    print('Usage:')
    print('bbm2.py<savefile>')
    exit(1)

file = open(sys.argv[1],'rb')
sav = list(bytearray(file.read()))
file.close()
assert len(sav) == 0x8000

main_payload = [
    0xFA,0x5C,0xDF,0xFE,0x79,0x28,0x31,0xF3,0x26,0x0A,0x74,0x26,0x40,0x36,0x02,0x01,
    0x04,0x00,0x11,0x80,0xFF,0x21,0x11,0xBB,0xCD,0xB5,0x00,0x0E,0x48,0x11,0x15,0xDF, 
    0xCD,0xB5,0x00,0x26,0x00,0x74,0x21,0x5E,0xD3,0x7E,0xFE,0x0B,0x20,0x09,0x36,0x76, 
    0x04,0x21,0xD1,0x5B,0xCD,0xD6,0x35,0xFB,0xCD,0x15,0xDF,0xC3,0x5B,0x4E,0x21,0x6F, 
    0xD3,0x11,0xA7,0xD6,0x7A,0xBE,0x28,0x1A,0x01,0x5E,0xD3,0x0A,0xFE,0x76,0x20,0x09, 
    0xFA,0x58,0xD3,0xA7,0x20,0x0C,0x3E,0x0B,0x02,0x3A,0x12,0x1B,0x7E,0x12,0x3E,0x6A, 
    0x22,0x72,0x21,0xEA,0xD6,0xCB,0x46,0x28,0x04,0x7D,0xEA,0x3C,0xD1,0xCB,0x4E,0x28, 
    0x03,0xCD,0x30,0xD4,0xCB,0x56,0x28,0x03,0xCD,0x42,0xD4,0x0E,0x46,0x3E,0xC3,0xC9, 
    0x06
]

main_payload_y = [
0xFA ,0x5C ,0xDF ,0xFE ,0x7C ,0x28 ,0x2F ,0xF3 ,0x3E ,0x02 ,0xCD ,0x99 ,0x3E ,0x01 ,0x04 ,0x00 
,0x11 ,0x80 ,0xFF ,0x21 ,0x11 ,0xBB ,0xCD ,0xB1 ,0x00 ,0x0E ,0x48 ,0x11 ,0x15 ,0xDF ,0xCD ,0xB1 
,0x00 ,0xCD ,0xA9 ,0x3E ,0x21 ,0x5D ,0xD3 ,0x7E ,0xFE ,0x0B ,0x20 ,0x09 ,0x36 ,0x76 ,0x04 ,0x21 
,0x83 ,0x5C ,0xCD ,0x84 ,0x3E ,0xFB ,0xCD ,0x15 ,0xDF ,0xC3 ,0xFA ,0x4D ,0x21 ,0x6E ,0xD3 ,0x11 
,0xA4 ,0xD6 ,0x7A ,0xBE ,0x28 ,0x1A ,0x01 ,0x5D ,0xD3 ,0x0A ,0xFE ,0x76 ,0x20 ,0x09 ,0xFA ,0x57 
,0xD3 ,0xA7 ,0x20 ,0x0C ,0x3E ,0x0B ,0x02 ,0x3A ,0x12 ,0x1B ,0x7E ,0x12 ,0x3E ,0x69 ,0x22 ,0x72 
,0x21 ,0xEE ,0xD6 ,0xCB ,0x46 ,0x28 ,0x04 ,0x7D ,0xEA ,0x3B ,0xD1 ,0xCB ,0x4E ,0x28 ,0x03 ,0xCD 
,0x9C ,0xD4 ,0xCB ,0x56 ,0x28 ,0x0A ,0x2E ,0xFF ,0xAF ,0xBE ,0x20 ,0x01 ,0x34 ,0xCD ,0x7A ,0xD4 
,0x0E ,0x46 ,0x3E ,0xC3 ,0xC9 ,0x06
]

scripts = [
0xFA,0x30,0xD7,0xA7,0xC0,0xF0,0xB4,0xCB,0x4F,0x3E,0x00,0x28,0x01,0x3C,0xEA,0x38, 
0xCD,0xC9,0x21,0x00,0xD7,0xAF,0xBE,0x20,0x01,0x34,0xFA,0x5E,0xD3,0xFE,0x1C,0xC8, 
0xF0,0xB4,0xCB,0x47,0xC8,0xFA,0xC5,0xCF,0xFE,0x07,0xD0,0xA7,0xC8,0xCD,0x27,0x0D, 
0x18,0xF3
]

scripts1_y = [
0xFA ,0x5D ,0xD3 ,0xFE ,0x1C ,0xC8 ,0xF0 ,0xB4 ,0xCB ,0x47 ,0xC8 ,0xFA ,0xC4 ,0xCF ,0xFE ,0x07 
,0xD0 ,0xA7 ,0xC8 ,0xCD ,0x7F ,0x0B ,0x18 ,0xF3
]

scripts2_y = [
0xFA ,0x2F ,0xD7 ,0xA7 ,0xC0 ,0xF0 ,0xB4 ,0xCB ,0x4F ,0x3E ,0x00 ,0x28 ,0x01 ,0x3C ,0xEA ,0x38 
,0xCD ,0xC9
]

launcer = [
0xCD,0xA8,0xD6,0xE2,0xF0,0xB4,0xCB,0x57,0xC8,0xF0,0xB8,0xF5,0xCD,0x2D,0xDF,0x21, 
0x27,0xDF,0xE5,0xCD,0xE8,0x29,0xF1,0xE0,0xB8,0xC3,0x07,0x23,0xCD,0x19,0x37,0x21, 
0x91,0xCF,0x36,0x94,0xAF,0xEA,0x94,0xCF,0xCD,0x51,0x09,0x0E,0x1F,0x3E,0x9D,0xCD,
0xA1,0x23,0x21,0xC4,0x70,0xCD,0x22,0x39,0x3E,0x1C,0xCD,0xE6,0x35,0x06,0x03,0x21, 
0x53,0xBA,0x11,0xE8,0xC6,0xE5,0xD5,0xC5,0xD5,0xCD,0x0F,0x79
]

launcer_y = [
0xCD ,0xA5 ,0xD6 ,0xE2 ,0xF0 ,0xB3 ,0xCB ,0x57 ,0xC8 ,0xF0 ,0xB8 ,0xF5 ,0xCD ,0x2D ,0xDF ,0x21 
,0x27 ,0xDF ,0xE5 ,0xCD ,0xD8 ,0x28 ,0xF1 ,0xE0 ,0xB8 ,0xC3 ,0x6B ,0x21 ,0xCD ,0x0F ,0x37 ,0x21 
,0x90 ,0xCF ,0x36 ,0x94 ,0xAF ,0xEA ,0x93 ,0xCF ,0xCD ,0x33 ,0x22 ,0x0E ,0x1F ,0x3E ,0x9D ,0xCD 
,0x11 ,0x22 ,0x21 ,0x39 ,0x6F ,0xCD ,0x17 ,0x39 ,0x3E ,0x1C ,0xCD ,0x92 ,0x3E ,0x06 ,0x03 ,0x21 
,0x53 ,0xBA ,0x11 ,0xE8 ,0xC6 ,0xE5 ,0xD5 ,0xC5 ,0xD5 ,0xCD ,0x58 ,0x7C
]

ramwriter = [
0x4B ,0x61 ,0x61 ,0x61 ,0x61 ,0x61 ,0x61 ,0x3E ,0x0A ,0xEA ,0x97 ,0xCF ,0xCD ,0x57 ,0x2D,0xA7 
,0x20 ,0x09 ,0xFA ,0x96 ,0xCF ,0x21 ,0xC0 ,0xC7 ,0xCD ,0x97 ,0x3D ,0xC1 ,0xE1 ,0xD1 ,0xCD,0x0E 
,0x79 ,0xCD ,0x92 ,0xC8 ,0xC3 ,0xFC ,0x09 ,0xE0 ,0xB6 ,0xE0 ,0xB7 ,0x21 ,0x00 ,0xDA ,0xCD,0x59 
,0xC7 ,0xE5 ,0x11 ,0xF8 ,0xFF ,0x19 ,0x54 ,0x5D ,0x01 ,0x0C ,0x00 ,0x21 ,0xA9 ,0xC3 ,0xF0,0xFE 
,0xCD ,0x4A ,0xC7 ,0x3E ,0x7C ,0x22 ,0x7A ,0xCD ,0x4A ,0xC7 ,0x7B ,0xCD ,0x4A ,0xC7 ,0x3E,0xE3 
,0x22 ,0x1A ,0xCD ,0x4A ,0xC7 ,0x36 ,0x7C ,0x09 ,0x13 ,0x7D ,0xFE ,0x13 ,0x20 ,0xE5 ,0x26,0x00 
,0x74 ,0x21 ,0x50 ,0xC4 ,0x36 ,0xED ,0xE1 ,0x18 ,0xC5 ,0xF5 ,0xCB ,0x37 ,0xCD ,0x51 ,0xC7,0xF1 
,0xE6 ,0x0F ,0xC6 ,0xF6 ,0xF6 ,0x80 ,0x22 ,0xC9 ,0xCD ,0xA5 ,0xC7 ,0x87 ,0x38 ,0x39 ,0xE5,0x87 
,0x30 ,0x03 ,0x43 ,0x87 ,0xC0 ,0xF0 ,0xFE ,0x80 ,0xE0 ,0xFE ,0x26 ,0x0A ,0x74 ,0x26 ,0x40,0x77 
,0xE1 ,0xF0 ,0xB5 ,0x0F ,0x30 ,0x24 ,0x4E ,0xE5 ,0xCD ,0xA5 ,0xC7 ,0xF0 ,0xB5 ,0x0F ,0x38 ,0x13 
,0x0F ,0x30 ,0x01 ,0x4B ,0x79 ,0x83 ,0x4F ,0x21 ,0x50 ,0xC4 ,0x36 ,0xEC ,0x23 ,0xCD ,0x4A ,0xC7 
,0xE1 ,0x18 ,0xE4 ,0x71 ,0xCD ,0xCE ,0x77 ,0xE1 ,0x18 ,0xBE ,0x0F ,0x30 ,0x03 ,0x53 ,0x1E ,0x00 
,0x0F ,0xD8 ,0x19 ,0xC9 ,0xCD ,0x31 ,0x38 ,0xF0 ,0xB5 ,0x76 ,0x11 ,0x00 ,0x00 ,0x43 ,0x87 ,0x30 
,0x01 ,0x13 ,0x87 ,0x30 ,0x01 ,0x1B ,0x87 ,0x30 ,0x03 ,0x11 ,0xF0 ,0xFF ,0x87 ,0xD0 ,0x1E ,0x10 
,0xC9 ,0x08 ,0xC7 ,0x51 ,0xC8 ,0xA1 ,0xC8 ,0x98 ,0xC8 ,0xAD ,0xC8 ,0xDB ,0xC8 ,0x24 ,0xC9 ,0x2E 
,0xC9 ,0x3B ,0xC9 ,0x5D ,0xC9 
]

ramwriter_y = [
0x4B ,0x61 ,0x61 ,0x61 ,0x61 ,0x61 ,0x61 ,0x3E ,0x0A ,0xEA ,0x96 ,0xCF ,0xCD ,0x51 ,0x2C ,0xA7 
,0x20 ,0x09 ,0xFA ,0x95 ,0xCF ,0x21 ,0xB9 ,0xC7 ,0xCD ,0x93 ,0x3D ,0xC1 ,0xE1 ,0xD1 ,0xCD ,0x57 
,0x7C ,0xC3 ,0x3D ,0x0F ,0xE0 ,0xB6 ,0xE0 ,0xB7 ,0x21 ,0x00 ,0xDA ,0xCD ,0x56 ,0xC7 ,0xE5 ,0x11 
,0xF8 ,0xFF ,0x19 ,0x54 ,0x5D ,0x01 ,0x0C ,0x00 ,0x21 ,0xA9 ,0xC3 ,0xF0 ,0xFD ,0xCD ,0x47 ,0xC7 
,0x3E ,0x7C ,0x22 ,0x7A ,0xCD ,0x47 ,0xC7 ,0x7B ,0xCD ,0x47 ,0xC7 ,0x3E ,0xE3 ,0x22 ,0x1A ,0xCD 
,0x47 ,0xC7 ,0x36 ,0x7C ,0x09 ,0x13 ,0x7D ,0xFE ,0x13 ,0x20 ,0xE5 ,0xCD ,0xA9 ,0x3E ,0x21 ,0x50 
,0xC4 ,0x36 ,0xED ,0xE1 ,0x18 ,0xC5 ,0xF5 ,0xCB ,0x37 ,0xCD ,0x4E ,0xC7 ,0xF1 ,0xE6 ,0x0F ,0xC6 
,0xF6 ,0xF6 ,0x80 ,0x22 ,0xC9 ,0xCD ,0x9E ,0xC7 ,0x87 ,0x38 ,0x36 ,0x87 ,0x30 ,0x05 ,0x43 ,0x87 
,0xC2 ,0x98 ,0x3E ,0xF0 ,0xFD ,0x80 ,0xE0 ,0xFD ,0xCD ,0x99 ,0x3E ,0xF0 ,0xB5 ,0x0F ,0x30 ,0x24 
,0x4E ,0xE5 ,0xCD ,0x9E ,0xC7 ,0xF0 ,0xB5 ,0x0F ,0x38 ,0x13 ,0x0F ,0x30 ,0x01 ,0x4B ,0x79 ,0x83 
,0x4F ,0x21 ,0x50 ,0xC4 ,0x36 ,0xEC ,0x23 ,0xCD ,0x47 ,0xC7 ,0xE1 ,0x18 ,0xE4 ,0x71 ,0xCD ,0x22 
,0x7B ,0xE1 ,0x18 ,0xC1 ,0x0F ,0x30 ,0x02 ,0x53 ,0x58 ,0x0F ,0xD8 ,0x19 ,0xC9 ,0xCD ,0x1E ,0x38 
,0xF0 ,0xB5 ,0x76 ,0x11 ,0x00 ,0x00 ,0x43 ,0x87 ,0x30 ,0x01 ,0x13 ,0x87 ,0x30 ,0x01 ,0x1B ,0x87 
,0x30 ,0x03 ,0x11 ,0xF0 ,0xFF ,0x87 ,0xD0 ,0x1E ,0x10 ,0xC9 ,0x05 ,0xC7 ,0x57 ,0xC8 ,0xA1 ,0xC8 
,0x98 ,0xC8 ,0xAD ,0xC8 ,0xDB ,0xC8 ,0x24 ,0xC9 ,0x2E ,0xC9 ,0x3B ,0xC9 ,0x5D ,0xC9
]

menuscripts = [
0x11 ,0xB5 ,0xD8 ,0xD5 ,0xD5 ,0x21 ,0x24 ,0x65 ,0xCD ,0x22 ,0x39 ,0x0E ,0x80 ,0x21 ,0x4B ,0xCF 
,0xD1 ,0x2A ,0x87 ,0x30 ,0x09 ,0x86 ,0x12 ,0x13 ,0x23 ,0x81 ,0x12 ,0x4F ,0x18 ,0xF3 ,0xD5 ,0x21 
,0x00 ,0xC4 ,0x0E ,0x01 ,0xCD ,0xDF ,0x15 ,0x2D ,0xCB ,0xFE ,0x20 ,0xFB ,0xCD ,0x31 ,0x38 ,0xF0 
,0xB5 ,0xE6 ,0x0F ,0x28 ,0xF7 ,0x1F ,0xD1 ,0x38 ,0xCB ,0x1B ,0x1F ,0x38 ,0xE1 ,0x1F ,0xE1 ,0xD8 
,0xE9 ,0xFA ,0x5E ,0xD3 ,0xC3 ,0xBC ,0x12 ,0x06 ,0x02 ,0x21 ,0xEA ,0xD6 ,0x7E ,0xA8 ,0x77 ,0xC9 
,0x06 ,0x01 ,0xCD ,0x9A ,0xC8 ,0xA0 ,0xC0 ,0xAF ,0xEA ,0x3C ,0xD1 ,0xC9 ,0x06 ,0x04 ,0x18 ,0xE9 
,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF 
,0xFF ,0xFF ,0xEA ,0x97 ,0xCF ,0xCD ,0x57 ,0x2D ,0xA7 ,0xFA ,0x96 ,0xCF ,0xC9 ,0x21 ,0x09 ,0xC4 
,0x11 ,0x6D ,0xCD ,0xCD ,0x29 ,0x38 ,0x2B ,0x36 ,0x7F ,0xC9 ,0xCD ,0x0F ,0x19 ,0x3E ,0xFF ,0xCD 
,0xC3 ,0xC8 ,0xC0 ,0xF5 ,0xEA ,0x1E ,0xD1 ,0xCD ,0xCF ,0x2F ,0xCD ,0xCE ,0xC8 ,0x3E ,0x63 ,0xCD 
,0xC3 ,0xC8 ,0xC1 ,0x20 ,0xE5 ,0x4F ,0xCD ,0x2E ,0x3E ,0x18 ,0xDF ,0xCD ,0x0F ,0x19 ,0x3E ,0x97 
,0xCD ,0xC3 ,0xC8 ,0x28 ,0x01 ,0xC9 ,0x11 ,0x1E ,0xD1 ,0x12 ,0x06 ,0x10 ,0x21 ,0xF9 ,0x4F ,0xCD 
,0xD6 ,0x35 ,0x1A ,0xF5 ,0xCD ,0x9E ,0x2F ,0xCD ,0xCE ,0xC8 ,0x3E ,0x64 ,0xCD ,0xC3 ,0xC8 ,0xC1 
,0x20 ,0xD9 ,0xC9 ,0xCD ,0xFC ,0xC8 ,0xC0 ,0x4F ,0xCD ,0x48 ,0x3E ,0x18 ,0xF6 ,0xCD ,0xFC ,0xC8 
,0xC0 ,0xEA ,0x2E ,0xCD ,0xFA ,0x1E ,0xD1 ,0xC3 ,0xDA ,0x32 ,0xCD ,0x0F ,0x19 ,0x3E ,0x2F ,0xCD 
,0xC3 ,0xC8 ,0xC0 ,0xEA ,0x31 ,0xD0 ,0xF5 ,0xCD ,0x9E ,0x35 ,0xCD ,0xCE ,0xC8 ,0xF1 ,0xC6 ,0xC8 
,0xEA ,0x1E ,0xD1 ,0x3E ,0x01 ,0xCD ,0xC3 ,0xC8 ,0x20 ,0xE0 ,0x18 ,0xD5 ,0x21 ,0x64 ,0xD1 ,0x2A 
,0x77 ,0x01 ,0x2C ,0x00 ,0x11 ,0x97 ,0xD1 ,0x2E ,0x6B ,0xCD ,0xB5 ,0x00 ,0x11 ,0xB5 ,0xD2 ,0x21 
,0xC0 ,0xD2 ,0xC3 ,0x29 ,0x38
]

menuscripts_y = [
0x11 ,0xB4 ,0xD8 ,0xD5 ,0xD5 ,0x21 ,0x95 ,0x62 ,0xCD ,0x17 ,0x39 ,0x0E ,0x80 ,0x21 ,0x4A ,0xCF 
,0xD1 ,0x2A ,0x87 ,0x30 ,0x09 ,0x86 ,0x12 ,0x13 ,0x23 ,0x81 ,0x12 ,0x4F ,0x18 ,0xF3 ,0xD5 ,0x21 
,0x00 ,0xC4 ,0x0E ,0x01 ,0xCD ,0xBF ,0x13 ,0x2D ,0xCB ,0xFE ,0x20 ,0xFB ,0xCD ,0x1E ,0x38 ,0xF0 
,0xB5 ,0xE6 ,0x0F ,0x28 ,0xF7 ,0x1F ,0xD1 ,0x38 ,0xCB ,0x1B ,0x1F ,0x38 ,0xE1 ,0x1F ,0xE1 ,0xD8 
,0xE9 ,0x06 ,0x02 ,0x21 ,0xEE ,0xD6 ,0x7E ,0xA8 ,0x77 ,0xC9 ,0x06 ,0x01 ,0xCD ,0x9A ,0xC8 ,0xA0 
,0xC0 ,0xAF ,0xEA ,0x3B ,0xD1 ,0xC9 ,0x06 ,0x04 ,0x18 ,0xE9 ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF 
,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xFF ,0xEA ,0x96 ,0xCF ,0xCD 
,0x51 ,0x2C ,0xA7 ,0xFA ,0x95 ,0xCF ,0xC9 ,0x21 ,0x09 ,0xC4 ,0x11 ,0x6D ,0xCD ,0xCD ,0x16 ,0x38 
,0x2B ,0x36 ,0x7F ,0xC9 ,0xCD ,0xDD ,0x16 ,0x3E ,0xFF ,0xCD ,0xC3 ,0xC8 ,0xC0 ,0xF5 ,0xEA ,0x1D 
,0xD1 ,0xCD ,0xC4 ,0x2E ,0xCD ,0xCE ,0xC8 ,0x3E ,0x63 ,0xCD ,0xC3 ,0xC8 ,0xC1 ,0x20 ,0xE5 ,0x4F 
,0xCD ,0x3F ,0x3E ,0x18 ,0xDF ,0xCD ,0xDD ,0x16 ,0x3E ,0x97 ,0xCD ,0xC3 ,0xC8 ,0x28 ,0x01 ,0xC9 
,0x11 ,0x1D ,0xD1 ,0x12 ,0x06 ,0x10 ,0x21 ,0x86 ,0x50 ,0xCD ,0x84 ,0x3E ,0x1A ,0xF5 ,0xCD ,0x93 
,0x2E ,0xCD ,0xCE ,0xC8 ,0x3E ,0x64 ,0xCD ,0xC3 ,0xC8 ,0xC1 ,0x20 ,0xD9 ,0xC9 ,0xCD ,0xFC ,0xC8 
,0xC0 ,0x4F ,0xCD ,0x59 ,0x3E ,0x18 ,0xF6 ,0xCD ,0xFC ,0xC8 ,0xC0 ,0xEA ,0x2E ,0xCD ,0xFA ,0x1D 
,0xD1 ,0xC3 ,0x76 ,0x32 ,0xCD ,0xDD ,0x16 ,0x3E ,0x2F ,0xCD ,0xC3 ,0xC8 ,0xC0 ,0xEA ,0x30 ,0xD0 
,0xF5 ,0xCD ,0xBB ,0x35 ,0xCD ,0xCE ,0xC8 ,0xF1 ,0xC6 ,0xC8 ,0xEA ,0x1D ,0xD1 ,0x3E ,0x01 ,0xCD 
,0xC3 ,0xC8 ,0x20 ,0xE0 ,0x18 ,0xD5 ,0x21 ,0x63 ,0xD1 ,0x2A ,0x77 ,0x01 ,0x2C ,0x00 ,0x11 ,0x96 
,0xD1 ,0x2E ,0x6A ,0xCD ,0xB1 ,0x00 ,0x11 ,0xB4 ,0xD2 ,0x21 ,0xBF ,0xD2 ,0xC3 ,0x16 ,0x38
]

if sav[0x2E1C] != 0x49:                             # indicates r/b sav
    if sav[0x261B] != 0xD6:                         # if MSP not patched
        sav[0x2916:0x2997] = main_payload           # transfer main payload in SRAM1
        sav[0x26DC:0x270E] = scripts                # transfer OAM DMA scripts in SRAM1
        sav[0x5B11:0x5B5D] = launcer                # transfer TimOS launcer in SRAM2
        sav[0x7A4C:0x7B41] = ramwriter              # transfer ramwriter in SRAM3
        sav[0x7BBC:0x7CE1] = menuscripts            # transfer TimOS scripts in SRAM3
        sav[0x2952:0x2954] = sav[0x261A:0x261C]     # transfer original to custom msp location  
        sav[0x261A:0x261C] = [0x6A,0xD6]            # patch msp
else:
    if sav[0x261B] != 0xD6:                         # if MSP not patched
        sav[0x2916:0x299C] = main_payload_y         # transfer main payload in SRAM1
        sav[0x2727:0x273F] = scripts1_y             # transfer OAM DMA scripts in SRAM1
        sav[0x2749:0x275B] = scripts2_y             # transfer OAM DMA scripts in SRAM1
        sav[0x5B11:0x5B5D] = launcer_y              # transfer TimOS launcer in SRAM2
        sav[0x7A4C:0x7B3A] = ramwriter_y            # transfer ramwriter in SRAM3
        sav[0x7BC2:0x7CE1] = menuscripts_y            # transfer TimOS scripts in SRAM3
        sav[0x2950:0x2952] = sav[0x261A:0x261C]     # transfer original to custom msp location  
        sav[0x261A:0x261C] = [0x69,0xD6]            # patch msp

checksum = 0xFF
for x in sav[0x2598:0x3523]:                    # calculates new checksum
    checksum -= x
    checksum %= 0x100
sav[0x3523] = checksum

assert len(sav) == 0x8000
file = open(sys.argv[1],'wb')
file.write(bytearray(sav))
file.close()

print('Done!')
